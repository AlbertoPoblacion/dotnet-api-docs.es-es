### <a name="accessibility-improvements-in-windows-forms-controls"></a>Mejoras de accesibilidad en controles de Windows Forms

|   |   |
|---|---|
|Detalles|Windows Forms mejora su funcionamiento con las tecnologías de accesibilidad para ofrecer una mejor compatibilidad con los clientes de Windows Forms. Entre otros, se incluyen los cambios siguientes:<ul><li>Cambios para mejorar la presentación durante el modo de contraste alto.</li><li>Cambios para mejorar la experiencia del Explorador de propiedades. Las mejoras en el Explorador de propiedades incluyen las siguientes:</li><li>Una mejor navegación mediante teclado gracias a las distintas ventanas de selección desplegables.</li><li>Se reducen las tabulaciones innecesarias.</li><li>Mejor notificación de tipos de control.</li><li>Comportamiento mejorado de Narrador.</li><li>Cambios para implementar los patrones de accesibilidad de interfaz de usuario que faltan en los controles.</li></ul>|
|Sugerencia|<strong>Cómo participar o no en estos cambios</strong> Para que la aplicación se beneficie de estos cambios, se debe ejecutar en .NET Framework 4.7.1 o una versión posterior. La aplicación se puede beneficiar de estos cambios de cualquiera de las maneras siguientes:<ul><li>Se recompila para tener .NET Framework 4.7.1 como destino. Estos cambios de accesibilidad están habilitados de forma predeterminada para las aplicaciones de Windows Forms destinadas a .NET Framework 4.7.1 o una versión posterior.</li><li>No participa en los comportamientos de accesibilidad heredados mediante la adición del [modificador de AppContext](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) a la sección <code>&lt;runtime&gt;</code> del archivo app.config y estableciéndolo en <code>false</code>, como se muestra en el ejemplo siguiente.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Las aplicaciones destinadas a .NET Framework 4.7.1 o una versión posterior, y cuando se quiere conservar el comportamiento de accesibilidad heredado, se puede participar en el uso de las características de accesibilidad heredadas si se establece explícitamente este modificador de AppContext en <code>true</code>. Para obtener información general sobre la automatización de la interfaz de usuario, vea [Información general sobre UI Automation](~/docs/framework/ui-automation/ui-automation-overview.md).<strong>Compatibilidad agregada para patrones y propiedades de Automatización de la interfaz de usuario</strong>Los clientes de accesibilidad pueden aprovechar las ventajas de las nuevas funciones de accesibilidad de WinForms mediante el uso de patrones de invocación comunes descritos de forma pública. Estos patrones no son específicos de WinForms. Por ejemplo, los clientes de accesibilidad pueden llamar el método QueryInterface en la interfaz IAccessible (MAAS) para obtener una interfaz IServiceProvider. Si esta interfaz está disponible, los clientes pueden usar su método QueryService para solicitar una interfaz IAccessibleEx. Para obtener más información, vea [Using IAccessibleEx from a Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx) (Uso de IAccessibleEx desde un cliente). A partir de .NET Framework 4.7.1, IServiceProvider e [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (cuando corresponda) están disponibles para los objetos de accesibilidad de WinForms. .NET Framework 4.7.1 agrega compatibilidad para los siguientes patrones y propiedades de automatización de la interfaz de usuario:<ul><li>Los controles <code>T:System.Windows.Forms.ToolStripSplitButton</code> y <code>T:System.Windows.Forms.ComboBox</code> admiten ahora el [patrón de expansión o contracción](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>El control <code>T:System.Windows.Forms.ToolStripMenuItem</code> tiene un valor de la propiedad [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) de <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>El control <code>T:System.Windows.Forms.ToolStripItem</code> admite la propiedad [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) y el [patrón de expansión o contracción](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>El control <code>T:System.Windows.Forms.ToolStripDropDownItem</code> admite eventos <xref:System.Windows.Forms.AccessibleEvents> en los que se indique StateChange y NameChange cuando la lista desplegable está expandida o contraída.</li><li>El control <code>T:System.Windows.Forms.ToolStripDropDownButton</code> tiene un valor de la propiedad [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) de <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>El control <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> ahora es compatible con el [patrón de alternancia](xref:System.Windows.Automation.TogglePattern).</li><li>Los controles <code>T:System.Windows.Forms.NumericUpDown</code> y <code>T:System.Windows.Forms.DomainUpDown</code> admiten [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) y tienen una propiedad [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) de <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Mejoras en el control PropertyGrid</strong> En .NET Framework 4.7.1 se agregan las mejoras siguientes para el control PropertyBrowser:<ul><li>El botón <strong>Detalles</strong> del cuadro de diálogo Error que se muestra cuando el usuario escribe un valor incorrecto en el control <code>T:System.Windows.Forms.PropertyGrid</code> admite el [patrón de expansión o contracción](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), notificaciones de cambio de estado y nombre, y una propiedad [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) con un valor de <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>El panel de mensajes que se muestra cuando se expande el botón <strong>Detalles</strong> del cuadro de diálogo Error ahora es accesible desde el teclado y permite que Narrador anuncie el contenido del mensaje de error.</li><li>El <xref:System.Windows.Forms.AccessibleRole> de las filas del control <code>T:System.Windows.Forms.PropertyGrid</code> ha cambiado de &quot;Fila&quot; a &quot;Celda&quot;. La celda se asigna a la propiedad ControlType de UIA &quot;DataItem&quot;, que le permite admitir los métodos abreviados de teclado adecuados y los anuncios de Narrador.</li><li>Las filas del control <code>T:System.Windows.Forms.PropertyGrid</code> que representan elementos de encabezado cuando el control <code>T:System.Windows.Forms.PropertyGrid</code> tiene una propiedad <code>P:System.Windows.Forms.PropertySort</code> establecida en <code>F:System.Windows.Forms.PropertySory.Categorized</code> tienen un valor de la propiedad [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) de <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType>.</li><li>Las filas del control <code>T:System.Windows.Forms.PropertyGrid</code> que representan elementos de encabezado cuando el control <code>T:System.Windows.Forms.PropertyGrid</code> tiene una propiedad <code>P:System.Windows.Forms.PropertySort</code> establecida en <code>F:System.Windows.Forms.PropertySory.Categorized</code> admiten el [patrón de expansión o contracción](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Navegación con el teclado mejorada entre la cuadrícula y la barra de herramientas situada por encima. Al presionar &quot;Mayús-Tab&quot; ahora se selecciona el primer botón de la barra de herramientas, en lugar de la barra de herramientas completa.</li><li>Los controles <code>T:System.Windows.Forms.PropertyGrid</code> que se muestran en el modo de contraste alto ahora dibujarán un rectángulo de foco alrededor del botón de la barra de herramientas que se corresponde al valor de la propiedad <code>P:System.Windows.Forms.PropertySort</code> actual.</li><li>Los controles <code>T:System.Windows.Forms.PropertyGrid</code> que se muestran en el modo de contraste alto y que tienen una propiedad <code>P:System.Windows.Forms.PropertySort</code> establecida en <code>F:System.Windows.Forms.PropertySory.Categorized</code> ahora mostrarán el fondo de los encabezados de categoría en un color de contraste alto.</li><li>Los controles <code>T:System.Windows.Forms.PropertyGrid</code> marcan mejor la diferencia entre los elementos de la barra de herramientas con el foco y los elementos que indican el valor actual de la propiedad <code>P:System.Windows.Forms.PropertySort</code>. Esta revisión está formada por un cambio de contraste alto y un cambio para los escenarios que no son de contraste alto.</li><li>Los elementos ToolBar del control <code>T:System.Windows.Forms.PropertyGrid</code> que indica el valor actual de la propiedad <code>P:System.Windows.Forms.PropertySort</code> admiten el [patrón de alternancia](xref:System.Windows.Automation.TogglePattern).</li><li>Compatibilidad mejorada de Narrador para distinguir la alineación seleccionada en el selector de alineación.</li><li>Cuando se muestra un control <code>T:System.Windows.Forms.PropertyGrid</code> vacío en un formulario, ahora recibirá el foco donde anteriormente no lo hacía.</li></ul><strong>Uso de colores definidos por el sistema operativo en los temas de contraste alto</strong><ul><li>En los controles <code>T:System.Windows.Forms.Button</code> y <code>T:System.Windows.Forms.CheckBox</code> con <code>P:System.Windows.Forms.Control.FlatStyle</code> establecido en <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, que es el estilo predeterminado, ahora se usan colores definidos por el sistema operativo en el tema de contraste alto cuando se seleccionan. Anteriormente, los colores de fondo y de texto no tenían contraste y eran difíciles de leer.</li><li>En <code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> y <code>T:System.Windows.Forms.GroupBox</code> con <code>P:System.Windows.Forms.Control.Enabled</code> establecido en <em>false</em>, se usa un color sombreado para representar el texto en los temas de contraste alto, lo que genera un contraste bajo sobre el fondo. Ahora, en estos controles se usa el color &quot;Texto deshabilitado&quot; definido por el sistema operativo. Esta revisión se aplica a los controles con la propiedad <code>P:System.Windows.Forms.Control.FlatStyle</code> establecida en un valor distinto de <code>F:System.Windows.Forms.FlatStyle.System</code>. El sistema operativo representa los últimos controles.</li><li><code>T:System.Windows.Forms.DataGridView</code> ahora representa un rectángulo visible alrededor del contenido de la celda que tiene el foco actual. Anteriormente, esto no era visible en determinados temas de contraste alto.</li><li>En los controles <code>T:System.Windows.Forms.ToolStripMenuItem</code> con una propiedad <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> establecida en <em>false</em> ahora se usa el color &quot;Texto deshabilitado&quot; definido por el sistema operativo.</li><li>Los controles <code>T:System.Windows.Forms.ToolStripMenuItem</code> con una propiedad <code>P:System.Windows.Forms.ToolStripItem.Checked</code> establecida en <em>true</em> ahora representan la marca de verificación asociada en un color del sistema en contraste.  Anteriormente, el color de la marca de verificación no tenía el contraste suficiente y no era visible en los temas de contraste alto.</li></ul>Nota: En Windows10 se han cambiado los valores para algunos colores del sistema de contraste alto. El marco de trabajo de Windows Forms se basa en el marco de trabajo de Win32. Para obtener la mejor experiencia, trabaje en la versión más reciente de Windows y use los cambios más recientes del sistema operativo mediante la adición de un archivo app.manifest en una aplicación de prueba y la eliminación de los comentarios del código siguiente:<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Navegación mejorada mediante el teclado</strong><ul><li>Cuando un control <code>T:System.Windows.Forms.ComboBox</code> tiene <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> establecido en <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> y es el primer control del orden de tabulación del formulario, ahora muestra un rectángulo de foco cuando el formulario principal se abre mediante el teclado. Antes de este cambio, el foco del teclado estaba en este control, pero no se representaba un indicador de foco.</li></ul><strong>Compatibilidad mejorada con Narrador</strong><ul><li>El control <code>T:System.Windows.Forms.MonthCalendar</code> ha agregado compatibilidad para que las tecnologías de asistencia tengan acceso al control, incluida la capacidad de Narrador de leer el valor del control cuando anteriormente no podía.</li><li>El control <code>T:System.Windows.Forms.CheckedListBox</code> ahora notifica a Narrador cuándo ha cambiado la propiedad <code>P:System.Windows.Forms.CheckState</code>. Anteriormente, Narrador no recibía notificaciones y, como resultado, no se informaba a los usuarios que <code>P:System.Windows.Forms.CheckState</code> se había actualizado.</li><li>El control <code>T:System.Windows.Forms.LinkLabel</code> ha cambiado la forma de notificar a Narrador el texto del control. Anteriormente, Narrador anunciaba dos veces este texto y leía los símbolos &quot;&amp;&quot; como texto real, aunque no eran visibles para los usuarios. El texto duplicado se quitó de los anuncios de Narrador, así como los símbolos &quot;&amp;&quot; innecesarios.</li><li>Los tipos de control <code>T:System.Windows.Forms.DataGridViewCell</code> ahora notifican correctamente el estado de solo lectura a Narrador y otras tecnologías de asistencia.</li><li>Ahora, Narrador puede leer el menú de sistema de las ventanas secundarias en las aplicaciones de [interfaz de múltiples documentos](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md).</li><li>Ahora, Narrador puede leer los controles <code>T:System.Windows.Forms.ToolStripMenuItem</code> con una propiedad <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> establecida en <em>false</em>. Anteriormente Narrador no podía centrarse en los elementos de menú deshabilitados para leer el contenido.</li></ul>|
|Ámbito|Major|
|Versión|4.7.1|
|Tipo|Redestinación|
|API afectadas|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

