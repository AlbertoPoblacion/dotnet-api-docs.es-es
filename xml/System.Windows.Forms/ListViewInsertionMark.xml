<Type Name="ListViewInsertionMark" FullName="System.Windows.Forms.ListViewInsertionMark">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="4a6e1417219fd062b40b84c805c35ea42ec6014c" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="es-ES" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
    <Meta Name="ms.locfileid" Value="30649129" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class ListViewInsertionMark" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ListViewInsertionMark extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Forms.ListViewInsertionMark" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class ListViewInsertionMark" />
  <TypeSignature Language="C++ CLI" Value="public ref class ListViewInsertionMark sealed" />
  <AssemblyInfo>
    <AssemblyName>System.Windows.Forms</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>Se utiliza para indicar la acción de colocar esperada cuando un elemento se arrastra hacia una nueva posición en un control <see cref="T:System.Windows.Forms.ListView" />. Esta funcionalidad sólo está disponible en Windows XP y posterior.</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 Puede recuperar un <xref:System.Windows.Forms.ListViewInsertionMark> desde el <xref:System.Windows.Forms.ListView.InsertionMark%2A> propiedad de un <xref:System.Windows.Forms.ListView> controlar y utilizarlo para indicar visualmente la ubicación de colocación esperada en una operación de arrastrar y colocar cuando se arrastra un elemento a una nueva posición.  
  
 Esta característica sólo funcionará cuando el <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=nameWithType> propiedad está establecida en `true` y cuándo el <xref:System.Windows.Forms.ListView> control no ordena los elementos automáticamente. Para evitar la ordenación automática, el <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=nameWithType> propiedad debe establecerse en <xref:System.Windows.Forms.SortOrder.None?displayProperty=nameWithType> y <xref:System.Windows.Forms.ListView.View%2A?displayProperty=nameWithType> propiedad debe establecerse en <xref:System.Windows.Forms.View.LargeIcon?displayProperty=nameWithType>, <xref:System.Windows.Forms.View.SmallIcon?displayProperty=nameWithType>, o <xref:System.Windows.Forms.View.Tile?displayProperty=nameWithType>. Además, no se puede usar la característica de marca de inserción con la <xref:System.Windows.Forms.ListView> característica de agrupación porque la característica de agrupación ordena los elementos por su pertenencia a grupo.  
  
 El <xref:System.Windows.Forms.ListViewInsertionMark> clase se usa normalmente en un controlador para el <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> o <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> evento para actualizar la posición de la marca de inserción cuando se arrastra un elemento. También se utiliza en un controlador para el <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> o <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> eventos para insertar un elemento arrastrado en la ubicación correcta.  
  
 Para actualizar la posición de la marca de inserción, siga estos pasos:  
  
1.  En un controlador para el <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> o <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> eventos, use la <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=nameWithType> propiedad para tener acceso a la <xref:System.Windows.Forms.ListViewInsertionMark> objeto asociado con el <xref:System.Windows.Forms.ListView> control.  
  
2.  Use la <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> método para recuperar el índice del elemento más próximo al puntero del mouse.  
  
3.  Pase el valor de índice para el <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> método para recuperar el rectángulo delimitador del elemento.  
  
4.  Si el puntero del mouse se encuentra a la izquierda del punto medio del rectángulo delimitador, establezca el <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propiedad `false`; en caso contrario, establézcalo en `true`.  
  
5.  Establecer el <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> propiedad en el valor de índice recuperado desde el <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> método. La marca de inserción aparece junto al elemento con el índice especificado, ya sea hacia la izquierda o la derecha, dependiendo de la <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> valor de propiedad. Si se arrastra un elemento sobre sí mismo, el índice es -1 y la marca de inserción está oculta.  
  
 Para insertar el elemento arrastrado en la ubicación correcta, siga estos pasos:  
  
1.  En un controlador para el <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> o <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> eventos, use la <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> propiedad para determinar la ubicación actual de la marca de inserción. Almacene este valor para usarlo más adelante como el índice de inserción.  
  
2.  Si el <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propiedad está establecida en `true`, incrementar el valor de índice de inserción almacenado.  
  
3.  Use la <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=nameWithType> método para insertar un clon del elemento arrastrado en la <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> colección en el índice de inserción almacenado.  
  
4.  Use la <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=nameWithType> método para quitar la copia original del elemento arrastrado.  
  
 Debe insertar un clon del elemento arrastrado antes de que se quita la copia original para el índice de valores en el <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> no se modifica la colección antes de la inserción.  
  
 Para asegurarse de que los elementos se muestran en el mismo orden que los valores de índice, debe establecer el <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=nameWithType> propiedad a una implementación de la <xref:System.Collections.IComparer> interfaz que ordena los elementos por valor de índice. Para obtener más información, vea la sección ejemplo.  
  
 Puede modificar el color de la marca de inserción mediante la <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> propiedad. Si necesita el tamaño o la posición de la marca de inserción, puede obtener su rectángulo delimitador mediante la <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> propiedad.  
  
> [!NOTE]
>  La característica de marca de inserción solo está disponible en Windows XP y la familia Windows Server 2003 cuando la aplicación llama a la <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> método. En sistemas operativos anteriores, se omitirá cualquier código relacionado con la marca de inserción y la marca de inserción no aparecerá. Como resultado, cualquier código que dependa de la característica de marca de inserción no funcionen correctamente. Puede van a incluir una prueba que determina si la característica de marca de inserción está disponible y proporcionar una funcionalidad alternativa cuando no está disponible. Por ejemplo, desea omitir todo el código que implementa la posición cuando se ejecuta en sistemas operativos que no admitan las marcas de inserción de arrastrar y colocar los elementos.  
>   
>  La característica de marca de inserción se proporciona la misma biblioteca que proporciona la característica de temas del sistema operativo. Para comprobar la disponibilidad de esta biblioteca, llame a la <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=nameWithType> sobrecarga del método y pase la <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=nameWithType> valor.  
  
   
  
## Examples  
 En el ejemplo de código siguiente se muestra cómo utilizar el <xref:System.Windows.Forms.ListView> característica de marca de inserción y la reordenación de elementos de arrastrar y colocar de implementa mediante el estándar de los eventos de arrastre. La posición de la marca de inserción se actualiza en un controlador para el <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> eventos. En este controlador, la posición del puntero del mouse se compara con el punto medio del elemento más cercano y el resultado se usa para determinar si la marca de inserción aparece a la izquierda o a la derecha del elemento.  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#1)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#1)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Windows.Forms.ListView" />
  </Docs>
  <Members>
    <Member MemberName="AppearsAfterItem">
      <MemberSignature Language="C#" Value="public bool AppearsAfterItem { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool AppearsAfterItem" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem" />
      <MemberSignature Language="VB.NET" Value="Public Property AppearsAfterItem As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool AppearsAfterItem { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Obtiene o establece un valor que indica si la marca de inserción aparece a la derecha del elemento con el índice especificado por la propiedad <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" />.</summary>
        <value>
          Es <see langword="true" /> si la marca de inserción aparece a la derecha del elemento con el índice especificado por la propiedad <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" />; en caso contrario, es <see langword="false" />. El valor predeterminado es <see langword="false" />.</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 El <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> método le permite buscar el elemento más próximo al puntero del mouse, pero debe hacer sus propios cálculos para determinar si la marca de inserción debe aparecer antes o después de este elemento.  
  
 Para calcular el valor necesario para la <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propiedad, siga estos pasos:  
  
1.  Use la <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> método para recuperar el índice del elemento más próximo al puntero del mouse.  
  
2.  Pase el valor de índice para el <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> método para recuperar el rectángulo delimitador del elemento.  
  
3.  Si el puntero del mouse se encuentra a la izquierda del punto medio del rectángulo delimitador, establezca el <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propiedad `false`; en caso contrario, establézcalo en `true`.  
  
 Para obtener más información, consulte el <xref:System.Windows.Forms.ListViewInsertionMark> tema de referencia de información general.  
  
   
  
## Examples  
 En el ejemplo de código siguiente se muestra cómo utilizar el <xref:System.Windows.Forms.ListView> característica de marca de inserción y la reordenación de elementos de arrastrar y colocar de implementa mediante el estándar de los eventos de arrastre. La posición de la marca de inserción se actualiza en un controlador para el <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> eventos. En este controlador, la posición del puntero del mouse se compara con el punto medio del elemento más cercano y el resultado se usa para determinar si la marca de inserción aparece a la izquierda o a la derecha del elemento.  
  
 Para obtener un ejemplo completo, vea el <xref:System.Windows.Forms.ListViewInsertionMark> tema de referencia de información general.  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Bounds">
      <MemberSignature Language="C#" Value="public System.Drawing.Rectangle Bounds { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Rectangle Bounds" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Bounds" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Bounds As Rectangle" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Drawing::Rectangle Bounds { System::Drawing::Rectangle get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Rectangle</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Obtiene el rectángulo delimitador de la marca de inserción.</summary>
        <value>Control <see cref="T:System.Drawing.Rectangle" /> que representa la posición y tamaño de la marca de inserción.</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 Las coordenadas de la marca de inserción del rectángulo delimitador son relativas a la esquina superior izquierda de la <xref:System.Windows.Forms.ListView> control.  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Color">
      <MemberSignature Language="C#" Value="public System.Drawing.Color Color { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Color Color" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Color" />
      <MemberSignature Language="VB.NET" Value="Public Property Color As Color" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Drawing::Color Color { System::Drawing::Color get(); void set(System::Drawing::Color value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Color</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Obtiene o establece el color de la marca de inserción.</summary>
        <value>Valor <see cref="T:System.Drawing.Color" /> que representa el color de la marca de inserción. El valor predeterminado es el valor de la propiedad <see cref="P:System.Windows.Forms.ListView.ForeColor" />.</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 Utilice esta propiedad para establecer el color de la marca de inserción en un valor distinto del color de primer plano de la <xref:System.Windows.Forms.ListView> control.  
  
   
  
## Examples  
 En el ejemplo de código siguiente se muestra cómo utilizar el <xref:System.Windows.Forms.ListView> característica de marca de inserción y la reordenación de elementos de arrastrar y colocar de implementa mediante el estándar de los eventos de arrastre. La posición de la marca de inserción se actualiza en un controlador para el <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> eventos. En este controlador, la posición del puntero del mouse se compara con el punto medio del elemento más cercano y el resultado se usa para determinar si la marca de inserción aparece a la izquierda o a la derecha del elemento.  
  
 Para obtener un ejemplo completo, vea el <xref:System.Windows.Forms.ListViewInsertionMark> tema de referencia de información general.  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#2)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#2)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Index">
      <MemberSignature Language="C#" Value="public int Index { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 Index" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Index" />
      <MemberSignature Language="VB.NET" Value="Public Property Index As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int Index { int get(); void set(int value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Obtiene o establece el índice del elemento junto al cual aparece la marca de inserción.</summary>
        <value>Índice del elemento junto al cual aparece la marca de inserción o -1 cuando la marca de inserción está oculta.</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 La marca de inserción aparece a la izquierda del elemento con el índice especificado si la <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propiedad está establecida en `false`; en caso contrario, aparece a la derecha del elemento. La marca de inserción desaparece automáticamente cuando un elemento arrastrado se inserta en la <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> colección. Para quitar la marca de inserción manualmente, por ejemplo, cuando un elemento se arrastra hacia sí mismo o arrastrar fuera del control, establezca la <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> valor-1.  
  
 Use la <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> método para recuperar el índice del elemento más próximo a una ubicación especificada, como la ubicación del puntero del mouse al colocar un elemento en una operación de arrastrar y colocar.  
  
   
  
## Examples  
 En el ejemplo de código siguiente se muestra cómo utilizar el <xref:System.Windows.Forms.ListView> característica de marca de inserción y la reordenación de elementos de arrastrar y colocar de implementa mediante el estándar de los eventos de arrastre. La posición de la marca de inserción se actualiza en un controlador para el <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> eventos. En este controlador, la posición del puntero del mouse se compara con el punto medio del elemento más cercano y el resultado se usa para determinar si la marca de inserción aparece a la izquierda o a la derecha del elemento.  
  
 Para obtener un ejemplo completo, vea el <xref:System.Windows.Forms.ListViewInsertionMark> tema de referencia de información general.  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="NearestIndex">
      <MemberSignature Language="C#" Value="public int NearestIndex (System.Drawing.Point pt);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 NearestIndex(valuetype System.Drawing.Point pt) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)" />
      <MemberSignature Language="VB.NET" Value="Public Function NearestIndex (pt As Point) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int NearestIndex(System::Drawing::Point pt);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pt" Type="System.Drawing.Point" />
      </Parameters>
      <Docs>
        <param name="pt">Control <see cref="T:System.Drawing.Point" /> que representa la ubicación desde dónde se puede encontrar el elemento más próximo.</param>
        <summary>Recupera el índice del elemento más próximo al punto especificado.</summary>
        <returns>Índice del elemento más próximo al punto especificado o -1 si el elemento más próximo es el elemento que se está arrastrando.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 Este método le permite buscar el elemento más próximo al puntero del mouse al realizar una operación de arrastrar y colocar. Use el valor de índice devuelto para establecer el <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> propiedad. Cuando el elemento más próximo al puntero del mouse es el elemento que se está arrastrando, el valor devuelto de este método es -1. En este caso, establecer el <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> este valor para propiedad oculta la marca de inserción.  
  
 Este método busca el elemento más próximo sin tener en cuenta que el puntero del mouse se encuentra, mientras el <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> método devuelve el elemento situado en la ubicación especificada, o `null` si no hay ningún elemento en esa ubicación. El <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> método `null`, por ejemplo, cuando el puntero del mouse se encuentra entre dos elementos. Por este motivo, debe utilizar siempre el <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> método cuando se usa una operación de arrastrar y colocar para colocar los elementos.  
  
   
  
## Examples  
 En el ejemplo de código siguiente se muestra cómo utilizar el <xref:System.Windows.Forms.ListView> característica de marca de inserción y la reordenación de elementos de arrastrar y colocar de implementa mediante el estándar de los eventos de arrastre. La posición de la marca de inserción se actualiza en un controlador para el <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> eventos. En este controlador, la posición del puntero del mouse se compara con el punto medio del elemento más cercano y el resultado se usa para determinar si la marca de inserción aparece a la izquierda o a la derecha del elemento.  
  
 Para obtener un ejemplo completo, vea el <xref:System.Windows.Forms.ListViewInsertionMark> tema de referencia de información general.  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
  </Members>
</Type>